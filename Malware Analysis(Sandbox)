Malware Behavior Analysis in Sandbox Using Process Monitor

Aim:
To set up a sandbox environment and analyze the behavior of a malware sample using Process Monitor by monitoring file system, registry, and network activities.

Environment Setup
Sandbox Machine
Windows 7 Virtual Machine
Network: Host‑Only (Isolated)

Tools:
Process Monitor (Sysinternals)
Process Explorer (Optional)
Wireshark (Optional)

Sample
Test Malware: eicar_test.exe (safe antivirus test file)

Step‑by‑Step Procedure
Step 1: Start Windows Sandbox VM
Boot the Windows virtual machine in isolated network mode.

Step 2: Take Snapshot
Create a snapshot in VirtualBox before running the sample.

Step 3: Launch Process Monitor
Open:
ProcessMonitor.exe

Step 4: Set Process Filter
Go to:
Filter → Filter
Process Name is eicar_test.exe → Include

Step 5: Clear Previous Logs
Ctrl + X

Step 6: Start Capturing Events
Ctrl + E

Step 7: Execute Malware Sample
Run:
eicar_test.exe

Step 8: Observe File System Activity
Suspicious actions observed:

File created in:
C:\Users\Public\
C:\Temp\

Hidden attributes set on dropped files
Step 9: Observe Registry Activity
Keys accessed:

HKCU\Software\Microsoft\Windows\CurrentVersion\Run
HKLM\Software\Microsoft\Windows\CurrentVersion\Run

Purpose:
Persistence (Auto‑start after reboot)

Step 10: Observe Process Behavior
New child process created
Attempted injection into explorer.exe
Background execution without UI

Step 11: Observe Network Activity (Wireshark)
DNS request to unknown domain
TCP connection to external IP
Suspicious outbound traffic on port 4444

Step 12: Stop Capture
Ctrl + E

Step 13: Analyze Logs
Indicators of compromise:
Unauthorized file creation
Registry persistence
Process injection
External command‑and‑control communication

Result:
The malware sample exhibited suspicious behavior including file drops, registry modification for persistence, abnormal process creation, and unauthorized network communication.

Conclusion:
Using a sandbox environment and Process Monitor, the dynamic behavior of the malware was successfully observed. This demonstrates how runtime monitoring helps identify malicious activities such as persistence, system modification, and network beaconing.
